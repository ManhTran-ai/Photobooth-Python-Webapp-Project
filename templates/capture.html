{% extends "base.html" %}
{% block title %}Capture - Photobooth{% endblock %}
{% block content %}

<div class="capture-page">
    <!-- Progress Indicator -->
    <div class="capture-progress">
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-text" id="progress-text">Photo 0/4</div>
    </div>

    <!-- Camera Interface -->
    <div class="capture-container">
        <!-- Countdown Overlay -->
        <div class="countdown-overlay" id="countdown-overlay" style="display: none;">
            <div class="countdown-content">
                <div class="countdown-number" id="countdown-number">3</div>
                <div class="countdown-label" id="countdown-label">Photo 1/4</div>
            </div>
        </div>

        <!-- Flash Effect -->
        <div class="flash-effect" id="flash-effect"></div>

        <!-- Video Preview -->
        <div class="video-wrapper">
            <video id="video" autoplay muted playsinline></video>
            <canvas id="canvas" style="display: none;"></canvas>
            
            <!-- Face Frame Guide -->
            <div class="face-guide" id="face-guide">
                <div class="guide-corner top-left"></div>
                <div class="guide-corner top-right"></div>
                <div class="guide-corner bottom-left"></div>
                <div class="guide-corner bottom-right"></div>
            </div>
        </div>

        <!-- Capture Controls -->
        <div class="capture-controls">
            <button class="btn btn-secondary" id="back-btn">
                <i class="icon">‚Üê</i> Back
            </button>
            <button class="btn btn-capture-large" id="start-session-btn">
                <i class="icon">üì∏</i> Start 4-Photo Session
            </button>
            <button class="btn btn-capture-large" id="capture-btn" style="display: none;">
                <i class="icon">üì∏</i> Capture Photo
            </button>
        </div>
    </div>

    <!-- Photo Preview Modal -->
    <div class="preview-modal" id="preview-modal" style="display: none;">
        <div class="preview-content">
            <h3 id="preview-title">Photo Preview</h3>
            <img id="preview-image" src="" alt="Preview">
            <div class="preview-buttons">
                <button class="btn btn-success" id="confirm-btn">
                    <i class="icon">‚úì</i> Looks Good
                </button>
                <button class="btn btn-danger" id="retake-btn">
                    <i class="icon">‚úó</i> Retake
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p id="loading-text">Processing...</p>
    </div>

    <!-- Error Message -->
    <div class="error-message" id="error-message" style="display: none;">
        <p id="error-text"></p>
        <button class="btn btn-primary" id="error-close">OK</button>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/capture.js') }}"></script>
{% endblock %}

